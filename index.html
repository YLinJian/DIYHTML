<!doctype html>

<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>实时地球壁纸</title>
  <style>
    :root{--bg:#0b1220;--card:#0f1720}
    html,body{height:100%;margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;color:#e6eef8;background:linear-gradient(180deg,#08101a 0%, #071420 60%);}
    .wrap{min-height:100%;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;padding:36px 16px 48px;box-sizing:border-box}
    .time-card{background:rgba(255,255,255,0.03);backdrop-filter:blur(6px);padding:10px 18px;border-radius:12px;margin-bottom:28px;box-shadow:0 6px 18px rgba(2,6,23,0.6);font-size:18px}
    .canvas-holder{width:40vmin;height:40vmin;max-width:64vw;max-height:64vw;min-width:280px;min-height:280px;display:flex;align-items:center;justify-content:center}
    canvas{display:block;width:100%;height:100%}
    .footer{margin-top:22px;color:rgba(230,238,248,0.7);font-size:13px}
    @media (max-width:600px){
      .time-card{font-size:16px;padding:8px 14px}
      .canvas-holder{width:60vmin;height:60vmin;min-width:220px;min-height:220px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div id="time" class="time-card" aria-live="polite">加载中…</div>
    <div class="canvas-holder" id="scene"></div>
    <div class="footer">地球贴图：NASA / 自动根据本地时区显示昼夜</div>
  </div>  <!-- Three.js from CDN -->  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>  <script src="https://cdn.jsdelivr.net/npm/three@0.158.0/examples/js/controls/OrbitControls.js"></script>  <script>
  // ——— 时间显示 ———
  const timeEl = document.getElementById('time');
  const weekdays = ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'];
  function pad(n){return n.toString().padStart(2,'0')}
  function formatCN(d){
    const Y=d.getFullYear();
    const M=pad(d.getMonth()+1);
    const D=pad(d.getDate());
    const h=pad(d.getHours());
    const m=pad(d.getMinutes());
    const s=pad(d.getSeconds());
    const w=weekdays[d.getDay()];
    return `${Y}年${M}月${D}日 ${h}:${m}:${s} ${w}`;
  }
  function tickTime(){
    const now=new Date();
    timeEl.textContent = formatCN(now);
  }
  setInterval(tickTime, 250);
  tickTime();

  // ——— Three.js 场景与地球 ———
  const container = document.getElementById('scene');
  const scene = new THREE.Scene();
  const renderer = new THREE.WebGLRenderer({antialias:true,alpha:true});
  renderer.setPixelRatio(window.devicePixelRatio);
  container.appendChild(renderer.domElement);

  const camera = new THREE.PerspectiveCamera(45,1,0.1,1000);
  camera.position.set(0,0,2.6);

  const controls = new THREE.OrbitControls(camera, renderer.domElement);
  controls.enablePan=false; controls.enableZoom=false; controls.autoRotate=false; controls.enableDamping=true; controls.maxPolarAngle = Math.PI/2 - 0.05;

  // lights
  const ambient = new THREE.AmbientLight(0xffffff, 0.15);
  scene.add(ambient);
  const sunLight = new THREE.DirectionalLight(0xffffff, 1.0);
  scene.add(sunLight);

  // Earth textures (NASA public images)
  const loader = new THREE.TextureLoader();
  const dayURL = 'https://eoimages.gsfc.nasa.gov/images/imagerecords/74000/74469/land_ocean_ice_2048.jpg';
  const nightURL = 'https://eoimages.gsfc.nasa.gov/images/imagerecords/74000/74468/earth_lights_lrg.jpg';
  const specURL = 'https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/textures/earthspec1k.jpg';

  const globeGroup = new THREE.Group();
  scene.add(globeGroup);

  Promise.all([loader.loadAsync(dayURL), loader.loadAsync(nightURL).catch(()=>null), loader.loadAsync(specURL).catch(()=>null)])
  .then(([dayTex, nightTex, specTex]) => {
    const geometry = new THREE.SphereGeometry(0.98, 64, 64);
    const material = new THREE.MeshPhongMaterial({
      map: dayTex,
      specularMap: specTex || null,
      shininess: 8,
      emissiveMap: nightTex || null,
      emissive: new THREE.Color(0xffffff),
      emissiveIntensity: 1.0
    });
    const earth = new THREE.Mesh(geometry, material);
    globeGroup.add(earth);

    // subtle cloud layer (optional)
    const cloudMat = new THREE.MeshLambertMaterial({map: loader.load('https://raw.githubusercontent.com/creativetimofficial/public-assets/master/earth/clouds.png'), transparent:true, opacity:0.6});
    const clouds = new THREE.Mesh(new THREE.SphereGeometry(1.01,64,64), cloudMat);
    globeGroup.add(clouds);

    // resize and render loop
    let lastTime = Date.now();
    function onResize(){
      const rect = container.getBoundingClientRect();
      renderer.setSize(rect.width, rect.height);
      camera.aspect = rect.width/rect.height;
      camera.updateProjectionMatrix();
    }
    window.addEventListener('resize', onResize);
    onResize();

    // compute sun position from current time (approximate)
    function sunDirectionFromDate(d){
      // UTC fractional hours
      const utc = new Date(d.getTime() + d.getTimezoneOffset()*60000);
  
